function addItem(e){if(inSetup){console.log(e.id);var t=prompt("Please enter a value in the following range: 0-9, o, h, k");if("h"===t)haveHero?alert("You can only have one hero!"):(document.getElementById(e.id).className="hero",theHero=new Hero(e.id));else if("o"===t)document.getElementById(e.id).className="obstacle",obstacles.push(new Obstacle(e.id));else if("k"===t)document.getElementById(e.id).className="killer",robots.push(new Robot(e.id));else if(parseInt(t)<10){document.getElementById(e.id).className="treasure";var o=new Treasure(e.id);o.value=parseInt(t),treasures.push(o)}else""!==t&&alert("Your input is invalid!")}else alert("You are not in the setup stage!")}function setup(){alert("Setup"),clear()}function clear(){for(var e=0;_size>e;e++)for(var t=0;_size>t;t++)document.getElementById("r"+e+"c"+t).className="";obstacles=[],robots=[],inSetup=!0,theHero=null,haveHero=!1,heroScore=0,robotsScore=0,round=0}function play(){null!==theHero?(inSetup=!1,round=1,heroTurn()):alert("You must have one hero!")}function heroTurn(){window.onkeypress=function(e){var t=e.key;document.getElementById("round").innerHTML="Round: "+round,heroMove(t)}}function heroMove(e){round++;var t,o=theHero.getLocation(),n=theHero.getRow(),r=theHero.getCol();switch(e){case"w":t=[n-1,r];break;case"a":t=[n,r-1];break;case"s":t=[n+1,r];break;case"d":t=[n,r+1];break;default:alert("This key is invalid!")}if(t[0]>=0&&t[0]<_size&&t[1]>=0&&t[1]<_size)if(detectStone(t))alert("You can't cross a obstacle!");else{var s="r"+t[0]+"c"+t[1],a=document.getElementById(s).className;"treasure"===a?(treasures.forEach(function(e,t){e.getLocation()===s&&(heroScore+=e.getValue(),console.log(heroScore),document.getElementById("score").innerHTML="Hero Score: "+heroScore+" Robots Score:"+robotsScore,treasures.splice(t,1))}),document.getElementById(s).className="hero",document.getElementById(o).className="",theHero.setLocation(s)):"killer"===a?(document.getElementById(o).className="",end()):(document.getElementById(s).className="hero",document.getElementById(o).className="",theHero.setLocation(s))}else alert("You can't cross the boundary!");0===treasures.length&&end(),robotTurn()}function detectStone(e){var t="r"+e[0]+"c"+e[1],o=document.getElementById(t).className;return"obstacle"===o}function robotTurn(){robots.forEach(function(e){console.log(e.getLocation());var t=e.getRow(),o=e.getCol(),n=e.getLocation(),r=theHero.getRow(),s=theHero.getCol(),a=theHero.getLocation();if(Math.abs(t-r)<=1&&Math.abs(o-s)<=1)document.getElementById(n).className="",document.getElementById(a).className="killer",end();else{var c=detectTreasure([t,o]);if("none"!==c)document.getElementById(n).className="",document.getElementById(c).className="killer",e.setLocation(c),treasures.forEach(function(e,t){e.getLocation()===c&&(robotsScore+=e.getValue(),treasures.splice(t,1),document.getElementById("score").innerHTML="Hero Score: "+heroScore+" Robots Score:"+robotsScore)});else{var u=randomMove([t,o]),i=Math.floor(Math.random()*u.length);console.log(i),document.getElementById(n).className="",document.getElementById(u[i]).className="killer",e.setLocation(u[i])}}})}function detectTreasure(e){for(var t=0===e[0]?0:e[0]-1;t<=(e[0]===_size-1?_size-1:e[0]+1);t++)for(var o=0===e[1]?0:e[1]-1;o<=(e[1]===_size-1?_size-1:e[1]+1);o++){var n="r"+t+"c"+o,r=document.getElementById(n).className;if("treasure"===r)return n}return"none"}function randomMove(e){for(var t=[],o=0===e[0]?0:e[0]-1;o<=(e[0]===_size-1?_size-1:e[0]+1);o++)for(var n=0===e[1]?0:e[1]-1;n<=(e[1]===_size-1?_size-1:e[1]+1);n++){var r="r"+o+"c"+n,s=document.getElementById(r).className;"obstacle"!==s&&"killer"!==s&&t.push(r)}return t}function end(){alert("Game is over!\nYour score is "+heroScore.toString()),clear()}var __extends=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();document.writeln("<h1>COMP284 Assignment2</h1>"),document.writeln("<h2 id='round'></h2>"),document.writeln("<h2 id='score'></h2>"),document.writeln("<table>");for(var _size=10,i=0;_size>i;i++){document.writeln("<tr>");for(var j=0;_size>j;j++)document.writeln("<td onclick='addItem(this)'id=r"+i+"c"+j+"></td>");document.writeln("</tr>")}document.writeln("</table>");var inSetup=!0,theHero,robots=[],obstacles=[],treasures=[],haveHero=!1,heroScore=0,robotsScore=0,round=0;document.getElementById("score").innerHTML="Hero Score: "+heroScore+" Robots Score:"+robotsScore,document.getElementById("round").innerHTML="Round: "+round;var Item=function(){function e(e){this.location=e}return e.prototype.getLocation=function(){return this.location},e.prototype.getRow=function(){return parseInt(this.location.charAt(1))},e.prototype.getCol=function(){return parseInt(this.location.charAt(3))},e.prototype.setLocation=function(e){this.location=e},e}(),Hero=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(Item),Robot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(Item),Obstacle=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(Item),Treasure=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getValue=function(){return this.value},t}(Item);